$(document).ready(function(){$(".user_dropdown").dropdown();$("#alert_container").alert();$(document).on("click","#logo a",function(a){a.preventDefault()});$("#user_create_form").validate({rules:{id:{required:true},name:{required:true,minlength:2}},errorElement:"div",errorPlacement:function(b,a){b.addClass("form-control-feedback");b.insertAfter(a)},highlight:function(a){$(a).parent().removeClass("has-success").addClass("has-danger");$(a).parent().find("input").removeClass("form-control-success").addClass("form-control-danger");console.log(a);console.log($(a))},unhighlight:function(a){$(a).parent().removeClass("has-danger").addClass("has-success");$(a).parent().find("input").removeClass("form-control-danger").addClass("form-control-success")}})});function saveRecord(d,b){var a=d.split(": ");var c={notification:a[0],message:a[1],cssClass:"danger"};switch(c.notification){case"success":c.cssClass="success";b();showAlertMessage(c);break;case"input-error":showAlertMessage(c);break;case"collision-error":showAlertMessage(c);break;default:showAlertMessage(c)}}function showAlertMessage(a){$.get("src/html/alert.html",function(b){$("#alert_container").remove();$("#master_container").append(Mustache.render($(b).html(),a));$("#alert_container").fadeIn("slow",function(){$(this).delay(5000).fadeOut("slow",function(){$(this).remove()})})})}$(document).ready(function(){$(document).on("click",".product_batch_list_link",function(a){a.preventDefault();showProductBatchListPage()});$(document).on("click",".product_batch_create_link",function(a){a.preventDefault();$.get("src/html/product_batch/product_batch_create.html",function(b){$("#content").html(b)})});$(document).on("click",".product_batch_edit_table_link",function(b){b.preventDefault();var a=$(this).parents("tr").children("td:first").text();getProductBatch(a).done(function(d){var c=d.status;$.get("src/html/product_batch/product_batch_edit.html",function(e){showProductBatchStatus(d);$("#content").html(Mustache.render($(e).html(),d));$(".pb_status").addClass("status_"+c);showProductBatchCompsPage(a)})}).fail(function(c){console.log(c)})})});function showProductBatchListPage(){getProductBatchList().done(function(a){$.get("src/html/product_batch/product_batch_list.html",function(b){$("#content").html(b);$.each(a,function(c,e){var d=e.status;showProductBatchStatus(e);$.get("src/html/product_batch/product_batch_list_row.html",function(f){$("#product_batch_list .table tbody").append(Mustache.render($(f).html(),e));$(".pb_status").addClass("status_"+d)})})})}).fail(function(a){console.log("Fejl!")})}function showProductBatchCompsPage(a){getProductBatchCompListSpecific(a).done(function(b){$.get("src/html/product_batch/product_batch_comp_list.html",function(c){$("#product_batch_edit_form").append(c);$.each(b,function(d,e){$.get("src/html/product_batch/product_batch_comp_list_row.html",function(f){$("#product_batch_comp_list .table tbody").append(Mustache.render($(f).html(),e))})})})})}function showProductBatchStatus(a){switch(a.status){case 0:a.status="Ikke påbegyndt";break;case 1:a.status="Under produktion";break;case 2:a.status="Afsluttet";break;default:console.log("Fejl i status kode");break}}function getProductBatch(a){return $.ajax({url:"rest/product_batch/read",type:"POST",data:a,contentType:"application/json"})}function getProductBatchCompListSpecific(a){return $.ajax({url:"rest/product_batch_comp/read_list_specific",type:"POST",data:a,contentType:"application/json"})}function getProductBatchList(){return $.ajax({url:"rest/product_batch/read_list",type:"GET",contentType:"application/json"})}$(document).ready(function(){$(document).on("click",".raw_material_batch_list_link",function(a){a.preventDefault();showRawMaterialBatchListPage()});$(document).on("click",".raw_material_batch_create_link",function(a){a.preventDefault();$.get("src/html/raw_material_batch/raw_material_batch_create.html",function(b){$("#content").html(b)})});$(document).on("click",".raw_material_batch_edit_table_link",function(b){b.preventDefault();var a=$(this).parents("tr").children("td:first").text();getRawMaterialBatch(a).done(function(c){$.get("src/html/raw_material_batch/raw_material_batch_edit.html",function(d){$("#content").html(Mustache.render($(d).html(),c))})}).fail(function(c){console.log(c)})});$(document).on("submit","#raw_material_batch_create_form",function(a){a.preventDefault();createRawMaterialBatch($(this).serializeJSON()).done(function(b){saveRecord(b,showRawMaterialBatchListPage)}).fail(function(b){console.log("Fejl i REST")})});$(document).on("submit","#raw_material_batch_edit_form",function(a){a.preventDefault();updateRawMaterialBatch($(this).serializeJSON()).done(function(c){var b=c.split(": ");switch(b[0]){case"success":showRawMaterialBatchListPage();alert(b[1]);break;case"input-error":alert(b[1]);break;case"collision-error":alert(b[1]);break;default:alert(b[1])}}).fail(function(b){console.log("Fejl i REST")})})});function updateRawMaterialBatch(a){return $.ajax({url:"rest/raw_material_batch/update",type:"PUT",contentType:"application/json",data:a})}function createRawMaterialBatch(a){return $.ajax({url:"rest/raw_material_batch/create",type:"POST",contentType:"application/json",data:a})}function showRawMaterialBatchListPage(){getRawMaterialBatchList().done(function(a){$.get("src/html/raw_material_batch/raw_material_batch_list.html",function(b){$("#content").html(b);$.each(a,function(c,d){$.get("src/html/raw_material_batch/raw_material_batch_list_row.html",function(e){$("#raw_material_batch_list .table tbody").append(Mustache.render($(e).html(),d))})})})}).fail(function(a){console.log("Fejl!")})}function getRawMaterialBatch(a){return $.ajax({url:"rest/raw_material_batch/read",type:"POST",data:a,contentType:"application/json"})}function getRawMaterialBatchList(){return $.ajax({url:"rest/raw_material_batch/read_list",type:"GET",contentType:"application/json"})}function getRawMaterialBatchListSpecific(a){return $.ajax({url:"rest/raw_material_batch/read_list_specific",type:"POST",data:a,contentType:"application/json"})}$(document).ready(function(){$(document).on("click",".recipe_list_link",function(a){a.preventDefault();showRecipeListPage()});$(document).on("click",".recipe_create_link",function(a){a.preventDefault();$.get("src/html/recipe/recipe_create.html",function(b){$("#content").html(b)})});$(document).on("click",".recipe_edit_table_link",function(b){b.preventDefault();var a=$(this).parents("tr").children("td:first").text();getRecipe(a).done(function(c){$.get("src/html/recipe/recipe_edit.html",function(d){$("#content").html(Mustache.render($(d).html(),c));showRecipeCompsPage(a)})}).fail(function(c){console.log(c)})});$(document).on("submit","#recipe_create_form",function(a){a.preventDefault();createRecipe($(this).serializeJSON()).done(function(d){var b=d.split(": ");switch(b[0]){case"success":var c=$('input[name="recipeId"]').val();getRecipe(c).done(function(e){$.get("src/html/recipe/recipe_edit.html",function(f){$("#content").html(Mustache.render($(f).html(),e))})}).fail(function(e){console.log(e)});showRecipeCompsPage(c);alert(b[1]);break;case"collision-error":alert(b[1]);break;default:alert(b[1])}}).fail(function(b){console.log(b)})});$(document).on("click",".recipe_comp_edit_table_link",function(c){c.preventDefault();var b=$('input[name="recipeId"]').val();var a=$(this).parents("tr").children("td:first").text();getRecipeComp(b,a).done(function(d){$.get("src/html/recipe/recipe_comp_edit.html",function(e){$("#content").html(Mustache.render($(e).html(),d))})}).fail(function(d){console.log(d)})});$(document).on("click",".recipe_comp_edit_link",function(a){a.preventDefault();updateRecipeComp().done(function(c){if(c=="success"){var b=$('input[name="recipeId"]').val();getRecipe(b).done(function(d){$.get("src/html/recipe/recipe_edit.html",function(e){$("#content").html(Mustache.render($(e).html(),d));showRecipeCompsPage(b)})}).fail(function(d){console.log(d)})}else{alert("Ikke opdateret.")}}).fail(function(b){console.log(b)})})});function showRecipeListPage(){getRecipeList().done(function(a){$.get("src/html/recipe/recipe_list.html",function(b){$("#content").html(b);$.each(a,function(c,d){$.get("src/html/recipe/recipe_list_row.html",function(e){$("#recipe_list .table tbody").append(Mustache.render($(e).html(),d))})})})}).fail(function(a){console.log("System fejl");alert("System fejl")})}function showRecipeCompsPage(a){getRecipeContent(a).done(function(b){$.get("src/html/recipe/recipe_comp_list.html",function(c){$("#recipe_edit_form").append(c);$.each(b,function(d,e){console.log(e);$.get("src/html/recipe/recipe_comp_list_row.html",function(f){$("#recipe_comp_list .table tbody").append(Mustache.render($(f).html(),e))})})})})}function updateRecipeComp(){return $.ajax({url:"rest/recipe_component/update",type:"PUT",contentType:"application/json",data:$("#recipe_comp_edit_form").serializeJSON()})}function getRecipeComp(b,a){var c=JSON.stringify({recipeId:b,rawMaterialId:a});return $.ajax({url:"rest/recipe_component/read",type:"POST",contentType:"application/json",data:c})}function createRecipe(a){return $.ajax({url:"rest/recipe/create",type:"POST",contentType:"application/json",data:a})}function getRecipeList(){return $.ajax({url:"rest/recipe/read_list",type:"GET",contentType:"application/json"})}function getRecipe(a){return $.ajax({url:"rest/recipe/read",type:"POST",data:a,contentType:"application/json"})}function getRecipeContent(a){return $.ajax({url:"rest/recipe_component/read_list_specific",type:"POST",data:a,contentType:"application/json"})}$(document).ready(function(){$(document).on("click",".raw_material_list_link",function(a){a.preventDefault();showRawMaterialListPage()});$(document).on("click",".raw_material_create_link",function(a){a.preventDefault();$.get("src/html/raw_material/raw_material_create.html",function(b){$("#content").html(b)})});$(document).on("click",".raw_material_edit_table_link",function(b){b.preventDefault();var a=$(this).parents("tr").children("td:first").text();getRawMaterial(a).done(function(c){$.get("src/html/raw_material/raw_material_edit.html",function(d){$("#content").html(Mustache.render($(d).html(),c))})}).fail(function(c){console.log(c)})});$(document).on("submit","#raw_material_create_form",function(a){a.preventDefault();$.ajax({url:"rest/raw_material/create",type:"POST",contentType:"application/json",data:$("#raw_material_create_form").serializeJSON(),success:function(b){if(b=="success"){showRawMaterialListPage();alert("Råvaren blev tilføjet")}else{alert(b)}},error:function(b){console.log(b)}})});$(document).on("submit","#raw_material_edit_form",function(a){a.preventDefault();$.ajax({url:"rest/raw_material/update",type:"PUT",contentType:"application/json",data:$("#raw_material_edit_form").serializeJSON(),success:function(b){if(b=="success"){showRawMaterialListPage();alert("Råvaren blev redigeret")}else{alert(b)}},error:function(b){console.log(b)}})})});function showRawMaterialListPage(){getRawMaterialList().done(function(a){$.get("src/html/raw_material/raw_material_list.html",function(b){$("#content").html(b);$.each(a,function(c,d){$.get("src/html/raw_material/raw_material_list_row.html",function(e){$("#raw_material_list .table tbody").append(Mustache.render($(e).html(),d))})})})}).fail(function(a){console.log("System fejl");alert("System fejl")})}function getRawMaterialList(){return $.ajax({url:"rest/raw_material/read_list",type:"GET",contentType:"application/json"})}function getRawMaterial(a){return $.ajax({url:"rest/raw_material/read",type:"POST",data:a,contentType:"application/json"})}$(document).ready(function(){$("body").load("src/html/login.html",function(){$('#login_form input[name="id"]').focus()});$(document).on("submit","#login_form",function(a){a.preventDefault();$.ajax({url:"rest/login/login-user",type:"POST",contentType:"application/json",data:$(this).serializeJSON(),success:function(c){switch(c){case"super_login":$.get("src/html/master.html",function(d){$("body").html(d);$("#user_dropdown_menu .user_edit_link").hide();$(".top_nav_role").addClass("role_super");$(".role_super").text("Super");$(".top_nav_name").text("admin");getRoleTemplate("src/html/role_privilege/admin_privilege.html").done(function(){getRoleTemplate("src/html/role_privilege/pharmacist_privilege.html").done(function(){getRoleTemplate("src/html/role_privilege/foreman_privilege.html").done(function(){getRoleTemplate("src/html/role_privilege/labtech_privilege.html")})})})});console.log(c);break;case"new_login":$.get("src/html/login_new_pass.html",function(d){$("body").html(d)});console.log(c);break;case"true_login":var b=$('#login_form input[name="id"]').val();getUser(b).done(function(d){$.get("src/html/master.html",function(e){$("body").html(Mustache.render($(e).html(),d));$("#user_dropdown_menu .user_edit_link").show();switch(d.role){case"Admin":$(".top_nav_role").addClass("role_admin");getRoleTemplate("src/html/role_privilege/admin_privilege.html");break;case"Farmaceut":$(".top_nav_role").addClass("role_pharmacist");getRoleTemplate("src/html/role_privilege/pharmacist_privilege.html").done(function(){getRoleTemplate("src/html/role_privilege/foreman_privilege.html").done(function(){getRoleTemplate("src/html/role_privilege/labtech_privilege.html")})});break;case"Værkfører":$(".top_nav_role").addClass("role_foreman");getRoleTemplate("src/html/role_privilege/foreman_privilege.html").done(function(){getRoleTemplate("src/html/role_privilege/labtech_privilege.html")});break;case"Laborant":$(".top_nav_role").addClass("role_labtech");getRoleTemplate("src/html/role_privilege/labtech_privilege.html");default:break}})}).fail(function(d){console.log("Fejl i User REST")});break;default:console.log(c)}},error:function(b){console.log("Fejl i Login REST")}})})});function getRoleTemplate(a){return $.get(a,function(b){$("#side_panel > #side_nav > ul").append(b)})}$(document).ready(function(){$(document).on("click",".user_edit_link",function(b){b.preventDefault();var a=$(".top_nav_userid").text();getUser(a).done(function(c){$.get("src/html/user/user_edit.html",function(d){$("#content").html(Mustache.render($(d).html(),c))})}).fail(function(c){console.log("Fejl!")})});$(document).on("click",".user_list_link",function(a){a.preventDefault();showUserListPage()});$(document).on("click",".user_create_link",function(a){a.preventDefault();$.get("src/html/user/user_create.html",function(b){$("#content").html(b)})});$(document).on("click",".user_edit_table_link",function(b){b.preventDefault();var a=$(this).parents("tr").children("td:first").text();getUser(a).done(function(c){$.get("src/html/user/user_edit.html",function(d){$("#content").html(Mustache.render($(d).html(),c))})}).fail(function(c){console.log("Fejl!")})});$(document).on("submit","#user_create_form",function(a){a.preventDefault();$.ajax({url:"rest/user/create",type:"POST",contentType:"application/json",data:$(this).serializeJSON(),success:function(c){var b=c.split(": ");switch(b[0]){case"success":alert(b[1]);showUserListPage();break;case"input-error":alert(b[1]);break;case"id-error":alert(b[1]);default:alert(b[1])}},error:function(b){console.log("Fejl!");console.log(b)}})});$(document).on("submit","#user_edit_form",function(a){a.preventDefault();$.ajax({url:"rest/user/update",type:"PUT",contentType:"application/json",data:$(this).serializeJSON(),success:function(b){console.log(b);switch(b){case"success":alert("Brugeren blev redigeret");showUserListPage();break;case"input-error":alert("Input fejl");break;default:alert("System fejl")}},error:function(b){console.log("Fejl!");console.log(b)}})})});function showUserListPage(){getUserList().done(function(a){$.get("src/html/user/user_list.html",function(b){$("#content").html(b);$.each(a,function(c,d){$.get("src/html/user/user_list_row.html",function(e){$("#user_list .table tbody").append(Mustache.render($(e).html(),d))})})})}).fail(function(a){console.log("Fejl!")})}function getUser(a){return $.ajax({url:"rest/user/read",type:"POST",data:a,contentType:"application/json"})}function getUserList(){return $.ajax({url:"rest/user/read_list",type:"GET",contentType:"application/json"})};